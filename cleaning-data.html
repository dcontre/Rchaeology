<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Cleaning data | Data Cleaning and Wrangling</title>
  <meta name="description" content="4 Cleaning data | Data Cleaning and Wrangling" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Cleaning data | Data Cleaning and Wrangling" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Cleaning data | Data Cleaning and Wrangling" />
  
  
  

<meta name="author" content="D. Contreras" />


<meta name="date" content="2025-02-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="acquiring-data.html"/>
<link rel="next" href="wrangling-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="to-do.html"><a href="to-do.html"><i class="fa fa-check"></i><b>1</b> to-do</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="acquiring-data.html"><a href="acquiring-data.html"><i class="fa fa-check"></i><b>3</b> Acquiring data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="acquiring-data.html"><a href="acquiring-data.html#reading-tabular-data"><i class="fa fa-check"></i><b>3.1</b> Reading tabular data</a></li>
<li class="chapter" data-level="3.2" data-path="acquiring-data.html"><a href="acquiring-data.html#scraping-.pdfs"><i class="fa fa-check"></i><b>3.2</b> Scraping .pdfs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cleaning-data.html"><a href="cleaning-data.html"><i class="fa fa-check"></i><b>4</b> Cleaning data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cleaning-data.html"><a href="cleaning-data.html#columnvariable-management"><i class="fa fa-check"></i><b>4.1</b> Column/variable management</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="cleaning-data.html"><a href="cleaning-data.html#removing-columns-with-select"><i class="fa fa-check"></i><b>4.1.1</b> Removing columns with <code>select()</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="cleaning-data.html"><a href="cleaning-data.html#changing-column-classes-and-adding-columns-with-mutate"><i class="fa fa-check"></i><b>4.1.2</b> Changing column classes and adding columns with <code>mutate()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="cleaning-data.html"><a href="cleaning-data.html#putting-it-into-practice"><i class="fa fa-check"></i><b>4.2</b> Putting it into practice</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="wrangling-data.html"><a href="wrangling-data.html"><i class="fa fa-check"></i><b>5</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="wrangling-data.html"><a href="wrangling-data.html#case_when"><i class="fa fa-check"></i><b>5.1</b> <code>case_when()</code></a></li>
<li class="chapter" data-level="5.2" data-path="wrangling-data.html"><a href="wrangling-data.html#left_join"><i class="fa fa-check"></i><b>5.2</b> <code>left_join()</code></a></li>
<li class="chapter" data-level="5.3" data-path="wrangling-data.html"><a href="wrangling-data.html#separate"><i class="fa fa-check"></i><b>5.3</b> <code>separate()</code></a></li>
<li class="chapter" data-level="5.4" data-path="wrangling-data.html"><a href="wrangling-data.html#bind_rows"><i class="fa fa-check"></i><b>5.4</b> <code>bind_rows()</code></a></li>
<li class="chapter" data-level="5.5" data-path="wrangling-data.html"><a href="wrangling-data.html#group_by-and-summarize"><i class="fa fa-check"></i><b>5.5</b> <code>group_by()</code> and <code>summarize()</code></a></li>
<li class="chapter" data-level="5.6" data-path="wrangling-data.html"><a href="wrangling-data.html#pivot_wider-and-pivot_longer"><i class="fa fa-check"></i><b>5.6</b> <code>pivot_wider()</code> and <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="5.7" data-path="wrangling-data.html"><a href="wrangling-data.html#combining-information"><i class="fa fa-check"></i><b>5.7</b> Combining information</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-payoff.html"><a href="the-payoff.html"><i class="fa fa-check"></i><b>6</b> The payoff</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-payoff.html"><a href="the-payoff.html#visualizing-the-data"><i class="fa fa-check"></i><b>6.1</b> Visualizing the data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="the-payoff.html"><a href="the-payoff.html#prop-plot"><i class="fa fa-check"></i><b>6.1.1</b> Source proportions plotted by artifact type and site</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-payoff.html"><a href="the-payoff.html#next-steps-after-exploratory-visualization"><i class="fa fa-check"></i><b>6.2</b> Next steps after exploratory visualization</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="the-payoff.html"><a href="the-payoff.html#diversity-indices"><i class="fa fa-check"></i><b>6.2.1</b> Diversity indices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="resourcestutorials.html"><a href="resourcestutorials.html"><i class="fa fa-check"></i><b>7</b> Resources/Tutorials</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Cleaning and Wrangling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cleaning-data" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Cleaning data<a href="cleaning-data.html#cleaning-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A few common data-cleaning tasks:</p>
<ul>
<li>adding and removing columns</li>
<li>converting character columns to factors</li>
</ul>
<p>We’ll do these the <strong>tidyverse</strong> [🙄] way, using <code>pipes</code> (<code>%&gt;%</code>), since we’re going to use the <strong>dplyr</strong> package and most of the examples you’ll find in the wild do so. Note that even using pipes, if you don’t write the result to an object (often overwriting the one that you feed into the pipe), it will be ephemeral. So, <code>drennan6.1b &lt;- drennan6.1b %&gt;%</code> is more likely to be useful than just <code>drennan6.1b %&gt;%</code>.</p>
<div id="columnvariable-management" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Column/variable management<a href="cleaning-data.html#columnvariable-management" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="removing-columns-with-select" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Removing columns with <code>select()</code><a href="cleaning-data.html#removing-columns-with-select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unless we’ve specified which cells we want with the <code>range =</code> argument when reading in the sheet, Table 6.1b has some extraneous columns produced because R detected text outside of the first four and expanded the range accordingly.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="cleaning-data.html#cb3-1" tabindex="-1"></a>drennan6<span class="fl">.1</span>b <span class="sc">%&gt;%</span> <span class="fu">select</span>(Site<span class="sc">:</span>Unincised)</span></code></pre></div>
<pre><code>## # A tibble: 140 × 4
##    Site          Unit  Incised Unincised
##    &lt;chr&gt;         &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1 Oak Grove     OG-29      31        86
##  2 Maple Knoll   MK-13      21        81
##  3 Cypress Swamp CS-40      43        84
##  4 Cypress Swamp CS-38      35        97
##  5 Cypress Swamp CS-12      29        87
##  6 Cypress Swamp CS-37      17        96
##  7 Cypress Swamp CS-19      37       115
##  8 Oak Grove     OG-42      39       111
##  9 Oak Grove     OG-4       25       101
## 10 Maple Knoll   MK-26      14        94
## # ℹ 130 more rows</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="cleaning-data.html#cb5-1" tabindex="-1"></a><span class="co">#or the inverse</span></span>
<span id="cb5-2"><a href="cleaning-data.html#cb5-2" tabindex="-1"></a>drennan6<span class="fl">.1</span>b <span class="ot">&lt;-</span> drennan6<span class="fl">.1</span>b <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">...5</span><span class="st">`</span>, <span class="st">`</span><span class="at">...6</span><span class="st">`</span>, <span class="st">`</span><span class="at">...7</span><span class="st">`</span>)) </span>
<span id="cb5-3"><a href="cleaning-data.html#cb5-3" tabindex="-1"></a><span class="co">#where column names have punctuation, enclose them in ``</span></span></code></pre></div>
</div>
<div id="changing-column-classes-and-adding-columns-with-mutate" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Changing column classes and adding columns with <code>mutate()</code><a href="cleaning-data.html#changing-column-classes-and-adding-columns-with-mutate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>mutate()</code> function can be used to modify existing columns by simply overwriting them.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="cleaning-data.html#cb6-1" tabindex="-1"></a>drennan6<span class="fl">.1</span>b <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Site =</span> <span class="fu">factor</span>(Site), <span class="at">Unit =</span> <span class="fu">factor</span>(Unit))</span></code></pre></div>
<pre><code>## # A tibble: 140 × 4
##    Site          Unit  Incised Unincised
##    &lt;fct&gt;         &lt;fct&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1 Oak Grove     OG-29      31        86
##  2 Maple Knoll   MK-13      21        81
##  3 Cypress Swamp CS-40      43        84
##  4 Cypress Swamp CS-38      35        97
##  5 Cypress Swamp CS-12      29        87
##  6 Cypress Swamp CS-37      17        96
##  7 Cypress Swamp CS-19      37       115
##  8 Oak Grove     OG-42      39       111
##  9 Oak Grove     OG-4       25       101
## 10 Maple Knoll   MK-26      14        94
## # ℹ 130 more rows</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="cleaning-data.html#cb8-1" tabindex="-1"></a><span class="co">#or, more efficiently where multiple columns are involved</span></span>
<span id="cb8-2"><a href="cleaning-data.html#cb8-2" tabindex="-1"></a>drennan6<span class="fl">.1</span>b <span class="ot">&lt;-</span> drennan6<span class="fl">.1</span>b <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(Site<span class="sc">:</span>Unit, as.factor))</span></code></pre></div>
<p>Mutate can also be used to create new columns, as assigning to <code>$</code> would (but remember that piping is ephemeral if you’re not writing to an object).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="cleaning-data.html#cb9-1" tabindex="-1"></a>drennan6<span class="fl">.1</span>b <span class="ot">&lt;-</span> drennan6<span class="fl">.1</span>b <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">PropIncised =</span> Incised<span class="sc">/</span>(Incised <span class="sc">+</span> Unincised))</span></code></pre></div>
</div>
</div>
<div id="putting-it-into-practice" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Putting it into practice<a href="cleaning-data.html#putting-it-into-practice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that you have seen how this works, let’s tidy up the Eerkens et al. tables so that we can use them. Looking at them, we’ll need to:</p>
<ul>
<li>make sure that no-data values are <code>NA</code>,</li>
<li>correct typos,</li>
<li>rename columns, making sure that they match between tables,</li>
<li>remove marginal totals,</li>
<li>add a ‘Site’ column, and</li>
<li>make sure that column classes are as we’d like.</li>
</ul>
<p>Below I’ll do this with Eerkens et al. 2007 Table 1; you’ll need to do the equivalent with Table 2 and Table 3 so that we can combine all three.</p>
<p>We’ll start by defining the no-data values. I find the <strong>dplyr</strong> syntax here a bit opaque…but it’s undeniably effective.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="cleaning-data.html#cb10-1" tabindex="-1"></a>eerk_tab1 <span class="sc">%&gt;%</span> <span class="fu">replace</span>(. <span class="sc">==</span> <span class="st">&quot;-&quot;</span>, <span class="cn">NA</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 10
##   `Source Artifact`         `Casa Diablo` `Mono GlassMtn.` Queen `Fish Springs`
##   &lt;chr&gt;                             &lt;dbl&gt;            &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;
## 1 Formal Tools                         51               16    13              5
## 2 Large Flakes                        166               65    10             18
## 3 Small Non-pressure Flakes            24               10     2              1
## 4 Small Pressure Flakes                 7                3     7              1
## 5 Totals                              248               94    32             25
## # ℹ 5 more variables: `Mono Craters` &lt;chr&gt;, `Bodie Hills` &lt;chr&gt;,
## #   `Mount Hicks` &lt;chr&gt;, Coso &lt;chr&gt;, Totals &lt;dbl&gt;</code></pre>
<p><span style="color: orange;">Do the same for Eerkens et al. 2007 Table 2 and Table 3.</span></p>
<p>We can “recode” to deal with typos (or any other values that we’d like to change). This used to be handled in <strong>dplyr</strong> by a function called - sensibly - <code>recode()</code>…but that has been replaced by one called <code>case_match()</code>. Although you can still use <code>recode()</code>, we’ll try to keep up with the times by using <code>case_match()</code> (<code>case_when()</code> also works for this).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="cleaning-data.html#cb12-1" tabindex="-1"></a>eerk_tab1 <span class="ot">&lt;-</span> eerk_tab1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Source Artifact</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_match</span>(<span class="st">`</span><span class="at">Source Artifact</span><span class="st">`</span>,</span>
<span id="cb12-2"><a href="cleaning-data.html#cb12-2" tabindex="-1"></a>                         <span class="st">&quot;FormalT ools&quot;</span> <span class="sc">~</span> <span class="st">&quot;Formal Tools&quot;</span>,</span>
<span id="cb12-3"><a href="cleaning-data.html#cb12-3" tabindex="-1"></a>                         <span class="at">.default =</span> <span class="st">`</span><span class="at">Source Artifact</span><span class="st">`</span></span>
<span id="cb12-4"><a href="cleaning-data.html#cb12-4" tabindex="-1"></a>                         ))</span></code></pre></div>
<p>The other two Eerkens tables don’t seem to need any recoding, so we can move on to the column names. Looking at the data frames and/or using <code>colnames()</code> will make clear that there are both typos and abbreviations in the column names. The former are obviously mistakes; the latter imposed by the formatting limitations of published tables. Fortunately we can refer to the full names on the published map. Since “BS/PP/FM” and “GF/LIW/RS” are lumping multiple nearby source and the full lists (“Bordwell Spring, PintoPeak,Fox Mountain, and Hart Mountain”, and “Grasshopper Flat, Lost Iron Well, and Red Switchback”) would be clunky column names, we’ll leave them as-is.</p>
<p><img src="imgs/Eerkens_2007_map.png" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="cleaning-data.html#cb13-1" tabindex="-1"></a><span class="co">#rename() syntax is &quot;NewName&quot; = &quot;OldName&quot;</span></span>
<span id="cb13-2"><a href="cleaning-data.html#cb13-2" tabindex="-1"></a><span class="co">#unlike recode(), only specified names will change</span></span>
<span id="cb13-3"><a href="cleaning-data.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="cleaning-data.html#cb13-4" tabindex="-1"></a>eerk_tab1 <span class="ot">&lt;-</span> eerk_tab1 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">&quot;Mono Glass Mountain&quot;</span> <span class="ot">=</span> <span class="st">&quot;Mono GlassMtn.&quot;</span>,</span>
<span id="cb13-5"><a href="cleaning-data.html#cb13-5" tabindex="-1"></a>                                  <span class="st">&quot;Truman/Queen&quot;</span> <span class="ot">=</span> <span class="st">&quot;Queen&quot;</span>)</span>
<span id="cb13-6"><a href="cleaning-data.html#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="cleaning-data.html#cb13-7" tabindex="-1"></a>eerk_tab2 <span class="ot">&lt;-</span> eerk_tab2 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">&quot;Buffalo Hills&quot;</span> <span class="ot">=</span> <span class="st">&quot;Buf. Hills&quot;</span>,</span>
<span id="cb13-8"><a href="cleaning-data.html#cb13-8" tabindex="-1"></a>                                  <span class="st">&quot;South Warners&quot;</span> <span class="ot">=</span> <span class="st">&quot;South War.&quot;</span>,</span>
<span id="cb13-9"><a href="cleaning-data.html#cb13-9" tabindex="-1"></a>                                  <span class="st">&quot;BS/PP/FM&quot;</span> <span class="ot">=</span> <span class="st">&quot;BS PP FM&quot;</span>,</span>
<span id="cb13-10"><a href="cleaning-data.html#cb13-10" tabindex="-1"></a>                                  <span class="st">&quot;GF/LIW/RS&quot;</span> <span class="ot">=</span> <span class="st">&quot;GF LIW RS&quot;</span>, </span>
<span id="cb13-11"><a href="cleaning-data.html#cb13-11" tabindex="-1"></a>                                  <span class="st">&quot;Cowhead Lake&quot;</span> <span class="ot">=</span> <span class="st">&quot;Cow. Lake&quot;</span>,</span>
<span id="cb13-12"><a href="cleaning-data.html#cb13-12" tabindex="-1"></a>                                  <span class="st">&quot;Cougar Butte&quot;</span> <span class="ot">=</span> <span class="st">&quot;Coug Butte&quot;</span>,</span>
<span id="cb13-13"><a href="cleaning-data.html#cb13-13" tabindex="-1"></a>                                  <span class="st">&quot;Buck Mountain&quot;</span> <span class="ot">=</span> <span class="st">&quot;Buck Mtn.&quot;</span>,</span>
<span id="cb13-14"><a href="cleaning-data.html#cb13-14" tabindex="-1"></a>                                  <span class="st">&quot;Napa Glass Mountain&quot;</span> <span class="ot">=</span> <span class="st">&quot;Napa&quot;</span>,</span>
<span id="cb13-15"><a href="cleaning-data.html#cb13-15" tabindex="-1"></a>                                  <span class="st">&quot;Mount Hicks&quot;</span> <span class="ot">=</span> <span class="st">&quot;Mt. Hicks&quot;</span>,</span>
<span id="cb13-16"><a href="cleaning-data.html#cb13-16" tabindex="-1"></a>                                  <span class="st">&quot;Truman/Queen&quot;</span> <span class="ot">=</span> <span class="st">&quot;Queen&quot;</span></span>
<span id="cb13-17"><a href="cleaning-data.html#cb13-17" tabindex="-1"></a>                                  )</span></code></pre></div>
<p><span style="color: orange;">Do the same for Eerkens et al. 2007 Table 3.</span></p>
<p>As you’ll have noticed above, column names with punctuation can be a hassle (need to be enclosed in tickmarks [<code>]).  The **janitor** package ("simple little tools for examining and cleaning dirty data") streamlines the standardization of these names (the</code>case=` argument controls whether you’ll get “Source Artifact”, “source_artifact”, or “SourceArtifact”, etc.).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="cleaning-data.html#cb14-1" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb14-2"><a href="cleaning-data.html#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="cleaning-data.html#cb14-3" tabindex="-1"></a><span class="fu">clean_names</span>(eerk_tab1, <span class="at">case =</span> <span class="st">&quot;snake&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 10
##   source_artifact      casa_diablo mono_glass_mountain truman_queen fish_springs
##   &lt;chr&gt;                      &lt;dbl&gt;               &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1 Formal Tools                  51                  16           13            5
## 2 Large Flakes                 166                  65           10           18
## 3 Small Non-pressure …          24                  10            2            1
## 4 Small Pressure Flak…           7                   3            7            1
## 5 Totals                       248                  94           32           25
## # ℹ 5 more variables: mono_craters &lt;chr&gt;, bodie_hills &lt;chr&gt;, mount_hicks &lt;chr&gt;,
## #   coso &lt;chr&gt;, totals &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="cleaning-data.html#cb16-1" tabindex="-1"></a><span class="co">#or piping</span></span>
<span id="cb16-2"><a href="cleaning-data.html#cb16-2" tabindex="-1"></a>eerk_tab1 <span class="ot">&lt;-</span> eerk_tab1 <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>(<span class="at">case =</span> <span class="st">&quot;snake&quot;</span>)</span></code></pre></div>
<p><span style="color: orange;">Do the same for Eerkens et al. 2007 Table 2 and Table 3.</span></p>
<p>The tables have row and column totals included, but since we’re going to combine them these will just get in the way. We already used <code>select()</code> to remove columns using <strong>dplyr</strong> (and you can do so just as easily by indexing using <code>[</code>); we can also use the <code>filter()</code> function to remove rows.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="cleaning-data.html#cb17-1" tabindex="-1"></a>eerk_tab1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>totals)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 9
##   source_artifact      casa_diablo mono_glass_mountain truman_queen fish_springs
##   &lt;chr&gt;                      &lt;dbl&gt;               &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1 Formal Tools                  51                  16           13            5
## 2 Large Flakes                 166                  65           10           18
## 3 Small Non-pressure …          24                  10            2            1
## 4 Small Pressure Flak…           7                   3            7            1
## 5 Totals                       248                  94           32           25
## # ℹ 4 more variables: mono_craters &lt;chr&gt;, bodie_hills &lt;chr&gt;, mount_hicks &lt;chr&gt;,
## #   coso &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="cleaning-data.html#cb19-1" tabindex="-1"></a>eerk_tab1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(source_artifact <span class="sc">!=</span> <span class="st">&quot;Totals&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 10
##   source_artifact      casa_diablo mono_glass_mountain truman_queen fish_springs
##   &lt;chr&gt;                      &lt;dbl&gt;               &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1 Formal Tools                  51                  16           13            5
## 2 Large Flakes                 166                  65           10           18
## 3 Small Non-pressure …          24                  10            2            1
## 4 Small Pressure Flak…           7                   3            7            1
## # ℹ 5 more variables: mono_craters &lt;chr&gt;, bodie_hills &lt;chr&gt;, mount_hicks &lt;chr&gt;,
## #   coso &lt;chr&gt;, totals &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="cleaning-data.html#cb21-1" tabindex="-1"></a><span class="co">#or chain those together with pipes</span></span>
<span id="cb21-2"><a href="cleaning-data.html#cb21-2" tabindex="-1"></a>eerk_tab1 <span class="ot">&lt;-</span> eerk_tab1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>totals) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(source_artifact <span class="sc">!=</span> <span class="st">&quot;Totals&quot;</span>)</span></code></pre></div>
<p><span style="color: orange;">Do the same for Eerkens et al. 2007 Table 2 and Table 3.</span></p>
<p>Each of the three tables contains information from a separate site, but the site name is in the table caption, not included as a variable. We can add an populate a column in <strong>dplyr</strong> using <code>mutate()</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="cleaning-data.html#cb22-1" tabindex="-1"></a>eerk_tab1 <span class="ot">&lt;-</span> eerk_tab1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">&quot;Sherwin Summit&quot;</span>)</span></code></pre></div>
<p><span style="color: orange;">Do the same for Eerkens et al. 2007 Table 2 and Table 3.</span></p>
<p>We can also use <code>mutate()</code> to alter column classes. We want to make sure, in particular, that our counts are ‘numeric’ rather than ‘character’ variables (<code>read_csv()</code> is likely to have guessed the to be character variables if it found <em>anything</em> non-numeric in them). We can do this efficiently by combining <code>across()</code> with <code>mutate()</code>. Referring to column names in code makes clear how useful <strong>janitor</strong>’s <code>clean_names()</code> function is (and how convenient “snake” case is for lazy typists).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="cleaning-data.html#cb23-1" tabindex="-1"></a>eerk_tab1 <span class="ot">&lt;-</span> eerk_tab1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(casa_diablo<span class="sc">:</span>coso, as.numeric))</span></code></pre></div>
<p><span style="color: orange;">Do the same for Eerkens et al. 2007 Table 2 and Table 3.</span></p>
<p>We might also want to turn some of our character variables into factors, but if we plan to combine the tables it’s usually safest to do that <em>after</em> combining.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="acquiring-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wrangling-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
