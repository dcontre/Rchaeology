<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Acquiring data | Data Cleaning and Wrangling</title>
  <meta name="description" content="3 Acquiring data | Data Cleaning and Wrangling" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Acquiring data | Data Cleaning and Wrangling" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Acquiring data | Data Cleaning and Wrangling" />
  
  
  

<meta name="author" content="D. Contreras" />


<meta name="date" content="2025-02-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="cleaning-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="to-do.html"><a href="to-do.html"><i class="fa fa-check"></i><b>1</b> to-do</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="acquiring-data.html"><a href="acquiring-data.html"><i class="fa fa-check"></i><b>3</b> Acquiring data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="acquiring-data.html"><a href="acquiring-data.html#reading-tabular-data"><i class="fa fa-check"></i><b>3.1</b> Reading tabular data</a></li>
<li class="chapter" data-level="3.2" data-path="acquiring-data.html"><a href="acquiring-data.html#scraping-.pdfs"><i class="fa fa-check"></i><b>3.2</b> Scraping .pdfs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cleaning-data.html"><a href="cleaning-data.html"><i class="fa fa-check"></i><b>4</b> Cleaning data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cleaning-data.html"><a href="cleaning-data.html#putting-it-into-practice"><i class="fa fa-check"></i><b>4.1</b> Putting it into practice</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="wrangling-data.html"><a href="wrangling-data.html"><i class="fa fa-check"></i><b>5</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="wrangling-data.html"><a href="wrangling-data.html#case_when"><i class="fa fa-check"></i><b>5.1</b> <code>case_when()</code></a></li>
<li class="chapter" data-level="5.2" data-path="wrangling-data.html"><a href="wrangling-data.html#left_join"><i class="fa fa-check"></i><b>5.2</b> <code>left_join()</code></a></li>
<li class="chapter" data-level="5.3" data-path="wrangling-data.html"><a href="wrangling-data.html#bind_rows"><i class="fa fa-check"></i><b>5.3</b> <code>bind_rows()</code></a></li>
<li class="chapter" data-level="5.4" data-path="wrangling-data.html"><a href="wrangling-data.html#group_by-and-summarize"><i class="fa fa-check"></i><b>5.4</b> <code>group_by()</code> and <code>summarize()</code></a></li>
<li class="chapter" data-level="5.5" data-path="wrangling-data.html"><a href="wrangling-data.html#pivot_wider-and-pivot_longer"><i class="fa fa-check"></i><b>5.5</b> <code>pivot_wider()</code> and <code>pivot_longer()</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-payoff.html"><a href="the-payoff.html"><i class="fa fa-check"></i><b>6</b> The payoff</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-payoff.html"><a href="the-payoff.html#visualizing-the-data"><i class="fa fa-check"></i><b>6.1</b> Visualizing the data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="the-payoff.html"><a href="the-payoff.html#prop-plot"><i class="fa fa-check"></i><b>6.1.1</b> Source proportions plotted by artifact type and site</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-payoff.html"><a href="the-payoff.html#next-steps-after-exploratory-visualization"><i class="fa fa-check"></i><b>6.2</b> Next steps after exploratory visualization</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="the-payoff.html"><a href="the-payoff.html#diversity-indices"><i class="fa fa-check"></i><b>6.2.1</b> Diversity indices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="resourcestutorials.html"><a href="resourcestutorials.html"><i class="fa fa-check"></i><b>7</b> Resources/Tutorials</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Cleaning and Wrangling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="acquiring-data" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Acquiring data<a href="acquiring-data.html#acquiring-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="reading-tabular-data" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Reading tabular data<a href="acquiring-data.html#reading-tabular-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can probably figure out a way to read just about any tabular data into R. We’ll look here at a couple of very straightforward but useful ones, and one slightly more clever one - but if you encounter messier data, be persistent.</p>
<p>We’ve loaded the <strong>dplyr</strong> package above, and we’ll add the <strong>readxl</strong>, <strong>googlesheets4</strong> packages here. They do exactly what you’d expect from the names. Since you’re already familiar with <code>read.csv()</code> and <code>read.delim</code> from Base R, we’ll skip those here. As it is wont to do, the <strong>tidyverse</strong> reinvents the wheel and adds a <code>read_csv()</code> function in the <strong>readr</strong> package. It it similar to the Base R function most of the time, but sometimes better at parsing files, and by default produces a <code>tibble</code>, which is a <strong>tidyverse</strong> version of a data frame.</p>
<p>You’ll find an .xlsx versions of a modified Drennan Table 6-1 in the ‘data’ folder, and a a google sheet version <a href="https://docs.google.com/spreadsheets/d/1bnZ7QSc1hjQ1HYQwXFNUHY3Yf4DLiNw4B68gl3texJc/edit?usp=sharing">here</a>. Try importing both just to see that both are possible, but then pick one - you only need one version of <code>drennan6.1b</code> and <code>drennan6.1b_2</code>.</p>
<p>Note that some information is stored on a second sheet; you’ll want that also. Note also that some information is encoded by highlighting cells. How might you alter the spreadhseet to make that information capturable?</p>
<p>To note: - .csv is the most easily and reliably readable tabular, but will not save formulas, colored cells, multiple sheets, etc. - …but when you read an .xlsx file you can’t easily capture that info anyway…so it’s not good practice to store information that way. For an .xlsx or a google sheet, you may to have specify which range of cells and/or which sheet you want.</p>
<p>For <code>googlesheets4::read_sheet()</code> to work, you may have to authenticate. If you don’t get prompted and you get authentication errors, try running <code>gs4_auth()</code> in the console.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="acquiring-data.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="acquiring-data.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb1-3"><a href="acquiring-data.html#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="acquiring-data.html#cb1-4" tabindex="-1"></a>drennan6<span class="fl">.1</span>b <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;data/Drennan_2009_Table6-1_b.xlsx&quot;</span>) <span class="co">#defaults to sheet 1</span></span>
<span id="cb1-5"><a href="acquiring-data.html#cb1-5" tabindex="-1"></a>drennan6<span class="fl">.1</span>b_2 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;data/Drennan_2009_Table6-1_b.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">2</span>) </span>
<span id="cb1-6"><a href="acquiring-data.html#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="acquiring-data.html#cb1-7" tabindex="-1"></a>drennan6<span class="fl">.1</span>b <span class="ot">&lt;-</span> <span class="fu">read_sheet</span>(<span class="st">&quot;https://docs.google.com/spreadsheets/d/1bnZ7QSc1hjQ1HYQwXFNUHY3Yf4DLiNw4B68gl3texJc/edit?usp=sharing&quot;</span>)</span>
<span id="cb1-8"><a href="acquiring-data.html#cb1-8" tabindex="-1"></a>drennan6<span class="fl">.1</span>b_2 <span class="ot">&lt;-</span> <span class="fu">read_sheet</span>(<span class="st">&quot;https://docs.google.com/spreadsheets/d/1bnZ7QSc1hjQ1HYQwXFNUHY3Yf4DLiNw4B68gl3texJc/edit?usp=sharing&quot;</span>, <span class="at">sheet =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Pick your favorite of the versions of this table and write it to an object. Because these data are clean, there’s no need to fuss with them much - but we may want to rearrange them a bit, and probably will find it convenient to convert some of the columns into factors for that reason. See ‘Data Cleaning’.</p>
</div>
<div id="scraping-.pdfs" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Scraping .pdfs<a href="acquiring-data.html#scraping-.pdfs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="imgs/tabula.png" width="20%" style="float:left; padding:10px" /></p>
<p><a href="https://tabula.technology/">Tabula</a></p>
<p>We’ll look at pages 589-592 from Eerkens et al. 2007<span class="citation">(Eerkens et al. 2007)</span>, which contains three tables of interest. Scrape all three using <strong>tabula</strong> (there is a <strong>tabulapdf</strong> package that provides an interface through R…but it generally doesn’t work as well), and save the three resulting .csv files in your ‘data’ folder. Examine the results, and you’ll find that the scraping isn’t perfect: characters may be misinterpreted (empty spaces and placeholders tend to cause trouble) and not everything winds up exactly where it should. This is generally easiest to fix by opening the .csv in MSExcel or something like it and editing there, comparing to the .pdf table to make sure you get accurate output.</p>
<p>Once you have the three tables looking as they should, read them in with <code>read.csv()</code> or <code>read_csv()</code>. If Tabula isn’t cooperating and/or you want to learn less, you can find .csv versions in the ‘data’ folder.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="acquiring-data.html#cb2-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb2-2"><a href="acquiring-data.html#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="acquiring-data.html#cb2-3" tabindex="-1"></a>eerk_tab1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/Eerkens_2007_Table1.csv&quot;</span>)</span>
<span id="cb2-4"><a href="acquiring-data.html#cb2-4" tabindex="-1"></a>eerk_tab2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/Eerkens_2007_Table2.csv&quot;</span>)</span>
<span id="cb2-5"><a href="acquiring-data.html#cb2-5" tabindex="-1"></a>eerk_tab3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/Eerkens_2007_Table3.csv&quot;</span>)</span></code></pre></div>
<p>What we want to do is tidy these tables up, and combine them into a single table that includes a variable for site (Table 1 is material from Sherwin Summit, Table 2 from Mohawk Valley, and Table 3 from Bone Cave). That desire leads us to…</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cleaning-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
